<% content_for :title, "Miniaturas" %>

<div class="w-full">
    <% if notice.present? %>
    <p class="py-2 px-3 bg-green-50 mb-5 text-green-500 font-medium rounded-md inline-block" id="notice"><%= notice %></p>
    <% end %>

    <div class="flex justify-between items-center mb-8">
        <h1 class="font-bold text-4xl">Minha coleção Miniaturas</h1>
        <%= link_to "New miniatura", new_miniatura_path, class: "rounded-md px-3.5 py-2.5 bg-blue-600 hover:bg-blue-500 text-white block font-medium" %>
    </div>

    <!-- FILTRO -->
    <div class="mb-6">
        <%= form_with url: miniaturas_path, method: :get, class: "flex gap-6 items-end" do |f| %>
        <div class="flex-1 max-w-xs">
            <%= f.label :marca_carro, "Filtrar por marca:", class: "block text-sm font-medium text-gray-700 mb-1" %>
            <%= f.select :marca_carro, 
          options_for_select(@marcas_carro, params[:marca_carro]), 
          { include_blank: "Todas as marcas" },
          class: "block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 h-8" %>
        </div>

        <div class="flex gap-2">
            <%= f.submit "Filtrar", class: "px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition" %>

            <% if params[:marca_carro].present? %>
            <%= link_to "Limpar", miniaturas_path, class: "px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition" %>
            <% end %>
        </div>
        <% end %>
    </div>


        <!-- CONTADOR DE MINIS -->
    <div class="mb-4 text-md text-gray-600">
        Mostrando <span class="text-lg font-bold"><%= @miniaturas.count%></span>
        <%= @miniaturas.count == 1 ? "miniatura" : "miniaturas" %>
        <% if params[:marca_carro].present? %>
        da marca <strong class="uppercase"><%= params[:marca_carro] %></strong>
        <% end %>
        </div>

    <div id="miniaturas" class="min-w-full divide-y divide-gray-200 space-y-5 mb-6">
        <% if @miniaturas.any? %>
        <table id="miniaturas_table" class="min-w-full bg-gray-100 shadow-lg rounded-lg overflow-hidden uppercase">
            <thead>
                <tr class="bg-gray-200 text-left text-gray-600 font-semibold">
                    <th class="py-3 px-4">Descricao</th>
                    <th class="py-3 px-4">Colecao</th>
                    <th class="py-3 px-4"> <%= sortable "linha", "Linha" %></th>
                    <th class="py-3 px-4"> <%= sortable "marca_carro", "Marca Carro" %></th>
                    <th class="py-3 px-4"><%= sortable "marca_mini", "Marca Mini" %></th>
                    <th class="py-3 px-4">Ano</th>
                </tr>
            </thead>
            <tbody>
                <% @miniaturas.each do |miniatura| %>
                <tr class="hover:bg-gray-200 transition cursor-pointer" onclick="window.location='<%= miniatura_path(miniatura) %>'">
                    <td class="py-2 px-4"><%= miniatura.descricao %></td>
                    <td class="py-2 px-4"><%= miniatura.colecao %></td>
                    <td class="py-2 px-4"><%= miniatura.linha  %></td>
                    <td class="py-2 px-4"><%= miniatura.marca_carro %></td>
                    <td class="py-2 px-4"><%= miniatura.marca_mini %></td>
                    <td class="py-2 px-4"><%= miniatura.ano %></td>
                </tr>
                <% end %>
            </tbody>
        </table>
        <% end %>
    </div>
</div>
